{"ast":null,"code":"import _slicedToArray from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from\"classnames\";import styles from\"./styles.module.css\";import{nanoid}from\"nanoid\";import{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{selectUsersIds,selectUsersIsLoading}from\"../../store/Users/selectors\";import{loadUsers}from\"../../store/Users/Thunks/loadUsers\";import{UserDataContainer}from\"../../Containers/UserDataContainer/UserDataContainer\";import{useSingleEffect}from\"../../hooks/UseSingleEffect\";import{PopupContainer}from\"../../Containers/PopupContainer/PopupContainer\";import{AddUserForm}from\"../../Components/AddUserForm/AddUserForm\";import{EditUserForm}from\"../../Components/EditUserForm/EditUserForm\";import{Table}from\"../../Components/Table/Table\";import{ButtonBar}from\"../../Components/ButtonsBar/ButtonsBar\";import{DeletePopup}from\"../../Components/DeletePopup/DeletePopup\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var USER_HEADERS=[\"#\",\"НАИМЕНОВАНИЕ\",\"E-mail\",\"Телефон\",\"Роль\",\"Франшиза\",\"Баланс\"];export var Users=function Users(){var navigate=useNavigate();var dispatch=useDispatch();var isLoading=useSelector(function(state){return selectUsersIsLoading(state);});useSingleEffect(function(){dispatch(loadUsers({userId:userId}));setIsRowSelected(false);},[]);var usersIds=useSelector(function(state){return selectUsersIds(state);});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isPopupOpened=_useState2[0],setIsPopupOpened=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isRowSelected=_useState4[0],setIsRowSelected=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditPopupOpened=_useState6[0],setIsEditPopupOpened=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isDeletePopupOpened=_useState8[0],setIsDeletePopupOpened=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),selectedRow=_useState10[0],setSelectedRow=_useState10[1];var userId=localStorage.userId/1;var toggleAddPopup=function toggleAddPopup(){setIsPopupOpened(!isPopupOpened);};var resetSelectedRow=function resetSelectedRow(){setSelectedRow(false);setIsRowSelected(false);};var toggleDeletePopup=function toggleDeletePopup(){setIsDeletePopupOpened(!isDeletePopupOpened);};var toggleEditPopup=function toggleEditPopup(){setIsEditPopupOpened(!isEditPopupOpened);};var toggleSelectedRow=function toggleSelectedRow(el){if(userId/1!==el){if(!!el){if(selectedRow===el){resetSelectedRow();}else{setIsRowSelected(true);setSelectedRow(el);}}else{resetSelectedRow();}}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:styles.users_wrapper,children:[/*#__PURE__*/_jsxs(Table,{children:[USER_HEADERS.map(function(el){return/*#__PURE__*/_jsx(\"th\",{className:classNames(styles.table_cell,styles.table_cell__header),children:el},nanoid());}),usersIds===null||usersIds===void 0?void 0:usersIds.map(function(id){return/*#__PURE__*/_jsx(UserDataContainer,{onclick:toggleSelectedRow,onDoubleClick:function onDoubleClick(){return navigate(\"/users/\".concat(id));},id:id,selectedRow:selectedRow},nanoid());})]}),/*#__PURE__*/_jsx(ButtonBar,{onClicks:[toggleAddPopup,toggleEditPopup,toggleDeletePopup],disabled:!isRowSelected}),isPopupOpened&&/*#__PURE__*/_jsx(PopupContainer,{togglePopup:toggleAddPopup,children:/*#__PURE__*/_jsx(AddUserForm,{togglePopup:toggleAddPopup})}),isDeletePopupOpened&&/*#__PURE__*/_jsx(DeletePopup,{id:selectedRow,toggleDeletePopup:toggleDeletePopup,resetSelectedRow:resetSelectedRow}),isEditPopupOpened&&/*#__PURE__*/_jsx(PopupContainer,{togglePopup:toggleEditPopup,children:/*#__PURE__*/_jsx(EditUserForm,{id:selectedRow,togglePopup:toggleEditPopup,resetSelectedRow:resetSelectedRow})})]});};","map":{"version":3,"names":["classNames","styles","nanoid","useState","useDispatch","useSelector","selectUsersIds","selectUsersIsLoading","loadUsers","UserDataContainer","useSingleEffect","PopupContainer","AddUserForm","EditUserForm","Table","ButtonBar","DeletePopup","useNavigate","USER_HEADERS","Users","navigate","dispatch","isLoading","state","userId","setIsRowSelected","usersIds","isPopupOpened","setIsPopupOpened","isRowSelected","isEditPopupOpened","setIsEditPopupOpened","isDeletePopupOpened","setIsDeletePopupOpened","selectedRow","setSelectedRow","localStorage","toggleAddPopup","resetSelectedRow","toggleDeletePopup","toggleEditPopup","toggleSelectedRow","el","users_wrapper","map","table_cell","table_cell__header","id"],"sources":["D:/dev/uno/src/Pages/Users/Users.jsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport styles from \"./styles.module.css\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  selectUsersIds,\r\n  selectUsersIsLoading,\r\n} from \"../../store/Users/selectors\";\r\nimport { loadUsers } from \"../../store/Users/Thunks/loadUsers\";\r\nimport { UserDataContainer } from \"../../Containers/UserDataContainer/UserDataContainer\";\r\nimport { useSingleEffect } from \"../../hooks/UseSingleEffect\";\r\nimport { PopupContainer } from \"../../Containers/PopupContainer/PopupContainer\";\r\nimport { AddUserForm } from \"../../Components/AddUserForm/AddUserForm\";\r\nimport { EditUserForm } from \"../../Components/EditUserForm/EditUserForm\";\r\nimport { Table } from \"../../Components/Table/Table\";\r\nimport { ButtonBar } from \"../../Components/ButtonsBar/ButtonsBar\";\r\nimport {DeletePopup} from \"../../Components/DeletePopup/DeletePopup\"\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst USER_HEADERS = [\r\n  \"#\",\r\n  \"НАИМЕНОВАНИЕ\",\r\n  \"E-mail\",\r\n  \"Телефон\",\r\n  \"Роль\",\r\n  \"Франшиза\",\r\n  \"Баланс\",\r\n];\r\n\r\nexport const Users = () => {\r\n  const navigate = useNavigate( )\r\n  const dispatch = useDispatch();\r\n  const isLoading = useSelector((state) => selectUsersIsLoading(state));\r\n  useSingleEffect(() => {\r\n    dispatch(loadUsers({ userId }));\r\n    setIsRowSelected(false);\r\n  }, []);\r\n  const usersIds = useSelector((state) => selectUsersIds(state));\r\n  const [isPopupOpened, setIsPopupOpened] = useState(false);\r\n  const [isRowSelected, setIsRowSelected] = useState(false);\r\n  const [isEditPopupOpened, setIsEditPopupOpened] = useState(false);\r\n  const [isDeletePopupOpened, setIsDeletePopupOpened] = useState(false);\r\n  const [selectedRow, setSelectedRow] = useState(false);\r\n\r\n  const userId = localStorage.userId / 1;\r\n\r\n  const toggleAddPopup = () => {\r\n    setIsPopupOpened(!isPopupOpened);\r\n  };\r\n  const resetSelectedRow = () => {\r\n    setSelectedRow(false);\r\n    setIsRowSelected(false);\r\n  };\r\n  const toggleDeletePopup = () => {\r\n    setIsDeletePopupOpened(!isDeletePopupOpened);\r\n  };\r\n\r\n  const toggleEditPopup = () => {\r\n    setIsEditPopupOpened(!isEditPopupOpened);\r\n  };\r\n\r\n  const toggleSelectedRow = (el) => {\r\n    if (userId / 1 !== el) {\r\n      if (!!el) {\r\n        if (selectedRow === el) {\r\n          resetSelectedRow();\r\n        } else {\r\n          setIsRowSelected(true);\r\n          setSelectedRow(el);\r\n        }\r\n      } else {\r\n        resetSelectedRow();\r\n      }\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className={styles.users_wrapper}>\r\n      <Table>\r\n          {USER_HEADERS.map((el) => {\r\n            return (\r\n              <th\r\n                key={nanoid()}\r\n                className={classNames(\r\n                  styles.table_cell,\r\n                  styles.table_cell__header\r\n                )}>\r\n                {el}\r\n              </th>\r\n            );\r\n          })}\r\n        {usersIds?.map((id) => {\r\n          return (\r\n            <UserDataContainer\r\n              onclick={toggleSelectedRow}\r\n              onDoubleClick={() => navigate(`/users/${id}`)}\r\n              id={id}\r\n              selectedRow={selectedRow}\r\n              key={nanoid()}\r\n            />\r\n          );\r\n        })}\r\n      </Table>\r\n      <ButtonBar\r\n        onClicks={[toggleAddPopup, toggleEditPopup, toggleDeletePopup]}\r\n        disabled={!isRowSelected}\r\n      />\r\n      {isPopupOpened && (\r\n        <PopupContainer togglePopup={toggleAddPopup}>\r\n          <AddUserForm togglePopup={toggleAddPopup} />\r\n        </PopupContainer>\r\n      )}\r\n      {isDeletePopupOpened && (\r\n        <DeletePopup\r\n          id={selectedRow}\r\n          toggleDeletePopup={toggleDeletePopup}\r\n          resetSelectedRow={resetSelectedRow}\r\n        />\r\n      )}\r\n      {isEditPopupOpened && (\r\n        <PopupContainer togglePopup={toggleEditPopup}>\r\n          <EditUserForm\r\n            id={selectedRow}\r\n            togglePopup={toggleEditPopup}\r\n            resetSelectedRow={resetSelectedRow}\r\n          />\r\n        </PopupContainer>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}