{"ast":null,"code":"import _slicedToArray from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{addUser}from\"../../store/Users/Thunks/addUser\";import{FormElem}from\"../FormElem/FormElem\";import{InputText}from\"../../UI/InputText/InputText\";import{InputPhone}from\"../../UI/InputPhone/InputPhone\";import{InputPass}from\"../../UI/InputPass/InputPass\";import{InputRadio}from\"../../UI/InputRadio/InputRadio\";import styles from\"./styles.module.css\";import{ROLES}from\"../../assets/constants/Fixtires\";import{getCityFransheses}from\"../../store/CityFranshises/Thunks/getCityFransheses\";import{selectCityFranshises,selectCityFranshisesIds}from\"../../store/CityFranshises/selectors\";import{InputDataSelect}from\"../InputDataList/InputDataSelect\";import{onSubmit as _onSubmit}from\"./helpers/onSubmit\";import{SelectedCity}from\"../SelectedCities/SelectedCities\";import{nanoid}from\"nanoid\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AddUserForm=function AddUserForm(_ref){var togglePopup=_ref.togglePopup;var cityFranIds=useSelector(function(state){return selectCityFranshisesIds(state);});var cityFran=useSelector(function(state){return selectCityFranshises(state);});var _localStorage=localStorage,userId=_localStorage.userId,userIdAccess=_localStorage.userIdAccess;var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),phone=_useState6[0],setPhone=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),city=_useState8[0],setCity=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),pass=_useState10[0],setPass=_useState10[1];var _useState11=useState(ROLES[0].id),_useState12=_slicedToArray(_useState11,2),role=_useState12[0],setRole=_useState12[1];var initialValidate={validate:undefined,errorMessage:\" \"};var availableCities=cityFranIds.filter(function(el){return!city.includes(el);});var _useState13=useState(initialValidate),_useState14=_slicedToArray(_useState13,2),validate=_useState14[0],setValidate=_useState14[1];useEffect(function(){dispatch(getCityFransheses({userId:userId}));},[userId]);useEffect(function(){if(validate.errorMessage.length<5&&phone.length>8){var cities=Object.values(cityFran).filter(function(el){return city.includes(el.NAME);}).map(function(el){return el.ID;});dispatch(addUser({userId:userId,email:email,role:role,name:name,phone:phone,pass:pass,cities:cities}));togglePopup();resetForm();}},[validate.errorMessage]);var resetForm=function resetForm(){setCity(\"\");setEmail(\"\");setName(\"\");setPass(\"\");setPhone(\"\");setRole(ROLES[0].id);};return/*#__PURE__*/_jsxs(FormElem,{title:\"Добавление пользователя\",onSubmit:function onSubmit(e){return _onSubmit(e,setValidate,{phone:phone,email:email,pass:pass,name:name,city:city,role:role});},children:[/*#__PURE__*/_jsx(InputText,{value:name,label:\"Наименование\",setValue:setName}),/*#__PURE__*/_jsx(InputText,{value:email,label:\"email\",setValue:setEmail}),/*#__PURE__*/_jsx(InputPhone,{value:phone,label:\"Телефон\",setValue:setPhone}),city.map(function(id){return/*#__PURE__*/_jsx(SelectedCity,{id:id},nanoid());}),/*#__PURE__*/_jsx(InputDataSelect,{city:city,cityFranIds:cityFranIds,setForm:setCity,label:\"Город\",availableCities:availableCities}),/*#__PURE__*/_jsx(InputPass,{value:pass,label:\"Пароль\",setValue:setPass}),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:styles.radios_label,children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.radios_container,children:ROLES.slice(userIdAccess==1?0:userIdAccess).map(function(el){var content=el.content,id=el.id;return/*#__PURE__*/_jsx(InputRadio,{label:content,value:id,checked:role===id,setValue:setRole},nanoid());})})]}),/*#__PURE__*/_jsx(\"span\",{className:styles.errorMessage,children:validate.errorMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:classNames(styles.button,styles.form_submit),children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"})]});};","map":{"version":3,"names":["classNames","useEffect","useState","useDispatch","useSelector","addUser","FormElem","InputText","InputPhone","InputPass","InputRadio","styles","ROLES","getCityFransheses","selectCityFranshises","selectCityFranshisesIds","InputDataSelect","onSubmit","SelectedCity","nanoid","AddUserForm","togglePopup","cityFranIds","state","cityFran","localStorage","userId","userIdAccess","dispatch","email","setEmail","name","setName","phone","setPhone","city","setCity","pass","setPass","id","role","setRole","initialValidate","validate","undefined","errorMessage","availableCities","filter","el","includes","setValidate","length","cities","Object","values","NAME","map","ID","resetForm","e","radios_label","radios_container","slice","content","button","form_submit"],"sources":["D:/dev/uno/src/Components/AddUserForm/AddUserForm.jsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addUser } from \"../../store/Users/Thunks/addUser\";\r\nimport { FormElem } from \"../FormElem/FormElem\";\r\nimport { InputText } from \"../../UI/InputText/InputText\";\r\nimport { InputPhone } from \"../../UI/InputPhone/InputPhone\";\r\nimport { InputPass } from \"../../UI/InputPass/InputPass\";\r\nimport { InputRadio } from \"../../UI/InputRadio/InputRadio\";\r\nimport styles from \"./styles.module.css\";\r\nimport { ROLES } from \"../../assets/constants/Fixtires\";\r\nimport { getCityFransheses } from \"../../store/CityFranshises/Thunks/getCityFransheses\";\r\nimport {\r\n  selectCityFranshises,\r\n  selectCityFranshisesIds,\r\n} from \"../../store/CityFranshises/selectors\";\r\nimport { InputDataSelect } from \"../InputDataList/InputDataSelect\";\r\nimport { onSubmit } from \"./helpers/onSubmit\";\r\nimport { SelectedCity } from \"../SelectedCities/SelectedCities\";\r\nimport { nanoid } from \"nanoid\";\r\n\r\nexport const AddUserForm = ({ togglePopup }) => {\r\n  const cityFranIds = useSelector((state) => selectCityFranshisesIds(state));\r\n  const cityFran = useSelector((state) => selectCityFranshises(state));\r\n  const { userId, userIdAccess } = localStorage;\r\n  const dispatch = useDispatch();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [city, setCity] = useState([]);\r\n  const [pass, setPass] = useState(\"\");\r\n  const [role, setRole] = useState(ROLES[0].id);\r\n  const initialValidate = {\r\n    validate: undefined,\r\n    errorMessage: \" \",\r\n  };\r\n\r\n  const availableCities = cityFranIds.filter(el => !city.includes(el))\r\n\r\n  const [validate, setValidate] = useState(initialValidate);\r\n  useEffect(() => {\r\n    dispatch(getCityFransheses({ userId }));\r\n  }, [userId]);\r\n  useEffect(() => {\r\n    if (validate.errorMessage.length < 5 && phone.length > 8) {\r\n      const cities = Object.values(cityFran).filter(el => city.includes(el.NAME)).map(el => el.ID)\r\n      dispatch(addUser({ userId, email, role, name, phone, pass, cities }));\r\n      togglePopup();\r\n      resetForm();\r\n    }\r\n  }, [validate.errorMessage]);\r\n\r\n  const resetForm = () => {\r\n    setCity(\"\");\r\n    setEmail(\"\");\r\n    setName(\"\");\r\n    setPass(\"\");\r\n    setPhone(\"\");\r\n    setRole(ROLES[0].id);\r\n  };\r\n\r\n  return (\r\n    <FormElem\r\n      title={\"Добавление пользователя\"}\r\n      onSubmit={(e) =>\r\n        onSubmit(e, setValidate, { phone, email, pass, name, city, role })\r\n      }>\r\n      <InputText\r\n        value={name}\r\n        label={\"Наименование\"}\r\n        setValue={setName}\r\n      />\r\n      <InputText\r\n        value={email}\r\n        label={\"email\"}\r\n        setValue={setEmail}\r\n      />\r\n      <InputPhone\r\n        value={phone}\r\n        label={\"Телефон\"}\r\n        setValue={setPhone}\r\n      />\r\n      {city.map((id) => \r\n          <SelectedCity\r\n            id={id}\r\n            key={nanoid()}\r\n          />\r\n        )}\r\n      <InputDataSelect\r\n        city={city}\r\n        cityFranIds={cityFranIds}\r\n        setForm={setCity}\r\n        label={\"Город\"}\r\n        availableCities={availableCities}\r\n      />\r\n      <InputPass\r\n        value={pass}\r\n        label={\"Пароль\"}\r\n        setValue={setPass}\r\n      />\r\n      {\r\n        <>\r\n          <span className={styles.radios_label}>Выберите роль:</span>\r\n          <div className={styles.radios_container}>\r\n            {ROLES.slice(userIdAccess == 1 ? 0 : userIdAccess).map((el) => {\r\n              const { content, id } = el;\r\n              return (\r\n                <InputRadio\r\n                  label={content}\r\n                  value={id}\r\n                  checked={role === id}\r\n                  setValue={setRole}\r\n                  key={nanoid()}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </>\r\n      }\r\n      <span className={styles.errorMessage}>{validate.errorMessage}</span>\r\n      <button\r\n        type=\"submit\"\r\n        className={classNames(styles.button, styles.form_submit)}>\r\n        Добавить ползователя\r\n      </button>\r\n    </FormElem>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}