{"ast":null,"code":"import _slicedToArray from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{addUser}from\"../../store/Users/Thunks/addUser\";import{FormElem}from\"../FormElem/FormElem\";import{InputText}from\"../../UI/InputText/InputText\";import{InputPhone}from\"../../UI/InputPhone/InputPhone\";import{InputPass}from\"../../UI/InputPass/InputPass\";import{InputRadio}from\"../../UI/InputRadio/InputRadio\";import styles from\"./styles.module.css\";import{isEmpty,isEmail,isMobilePhone,isAlpha}from\"validator\";import{loadUsers}from\"../../store/Users/Thunks/loadUsers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ROLES={admin:{content:\"admin\",id:1},user:{content:\"user\",id:3},master:{content:\"master\",id:2}};export var AddUserForm=function AddUserForm(_ref){var togglePopup=_ref.togglePopup;var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),phone=_useState6[0],setPhone=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),city=_useState8[0],setCity=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),pass=_useState10[0],setPass=_useState10[1];var _useState11=useState(ROLES.user.id),_useState12=_slicedToArray(_useState11,2),role=_useState12[0],setRole=_useState12[1];var initialValidate={validate:undefined,errorMessage:\" \"};var _useState13=useState(initialValidate),_useState14=_slicedToArray(_useState13,2),validate=_useState14[0],setValidate=_useState14[1];useEffect(function(){if(validate.errorMessage.length<5&&phone.length>8){dispatch(addUser({userId:userId,email:email,role:role,name:name,phone:phone,pass:pass}));dispatch(loadUsers({userId:userId}));togglePopup();resetForm();}},[validate.errorMessage]);var userId=localStorage.userId;var resetForm=function resetForm(){setCity(\"\");setEmail(\"\");setName(\"\");setPass(\"\");setPhone(\"\");setRole(ROLES.user.id);};var handleValidate=function handleValidate(){if(isEmpty(email)||isEmpty(phone)||isEmpty(city)||isEmpty(pass)||isEmpty(name)){setValidate({isValid:false,errorMessage:\"Пожалуйста, заполните все поля\"});}else if(!isEmail(email)){setValidate({isValid:false,errorMessage:\"Неверный формат почты\"});}else if(!isMobilePhone(phone)||phone.length<10||phone.length>14){setValidate({isValid:false,errorMessage:\"Неверный номер телефона\"});}else setValidate({isValid:true,errorMessage:\"   \"});};var onSubmit=function onSubmit(event){event.preventDefault();handleValidate();};return/*#__PURE__*/_jsxs(FormElem,{title:\"Добавление пользователя\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(InputText,{value:name,label:\"Наименование\",setValue:setName}),/*#__PURE__*/_jsx(InputText,{value:email,label:\"email\",setValue:setEmail}),/*#__PURE__*/_jsx(InputPhone,{value:phone,label:\"Телефон\",setValue:setPhone}),/*#__PURE__*/_jsx(InputText,{value:city,label:\"Город\",setValue:setCity}),/*#__PURE__*/_jsx(InputPass,{value:pass,label:\"Пароль\",setValue:setPass}),/*#__PURE__*/_jsx(\"span\",{className:styles.radios_label,children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.radios_container,children:[/*#__PURE__*/_jsx(InputRadio,{label:ROLES.user.content,value:ROLES.user.id,checked:role===ROLES.user.id,setValue:setRole}),/*#__PURE__*/_jsx(InputRadio,{label:ROLES.master.content,value:ROLES.master.id,checked:role===ROLES.master.id,setValue:setRole}),/*#__PURE__*/_jsx(InputRadio,{label:ROLES.admin.content,value:ROLES.admin.id,checked:role===ROLES.admin.id,setValue:setRole})]}),/*#__PURE__*/_jsx(\"span\",{className:styles.errorMessage,children:validate.errorMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:classNames(styles.button,styles.form_submit),children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"})]});};","map":{"version":3,"names":["classNames","useEffect","useState","useDispatch","addUser","FormElem","InputText","InputPhone","InputPass","InputRadio","styles","isEmpty","isEmail","isMobilePhone","isAlpha","loadUsers","ROLES","admin","content","id","user","master","AddUserForm","togglePopup","dispatch","email","setEmail","name","setName","phone","setPhone","city","setCity","pass","setPass","role","setRole","initialValidate","validate","undefined","errorMessage","setValidate","length","userId","resetForm","localStorage","handleValidate","isValid","onSubmit","event","preventDefault","radios_label","radios_container","button","form_submit"],"sources":["D:/dev/uno/src/Components/AddUserForm/AddUserForm.jsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { addUser } from \"../../store/Users/Thunks/addUser\";\r\nimport { FormElem } from \"../FormElem/FormElem\";\r\nimport { InputText } from \"../../UI/InputText/InputText\";\r\nimport { InputPhone } from \"../../UI/InputPhone/InputPhone\";\r\nimport { InputPass } from \"../../UI/InputPass/InputPass\";\r\nimport { InputRadio } from \"../../UI/InputRadio/InputRadio\";\r\nimport styles from \"./styles.module.css\";\r\nimport { isEmpty, isEmail, isMobilePhone, isAlpha } from \"validator\";\r\nimport { loadUsers } from \"../../store/Users/Thunks/loadUsers\";\r\n\r\nconst ROLES = {\r\n  admin: { content: \"admin\", id: 1 },\r\n  user: { content: \"user\", id: 3 },\r\n  master: { content: \"master\", id: 2 },\r\n};\r\n\r\nexport const AddUserForm = ({ togglePopup }) => {\r\n  const dispatch = useDispatch();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [city, setCity] = useState(\"\");\r\n  const [pass, setPass] = useState(\"\");\r\n  const [role, setRole] = useState(ROLES.user.id);\r\n  const initialValidate = {\r\n    validate: undefined,\r\n    errorMessage: \" \",\r\n  };\r\n  const [validate, setValidate] = useState(initialValidate);\r\n  useEffect(() => {\r\n    if (validate.errorMessage.length < 5 && phone.length > 8) {\r\n      dispatch(addUser({ userId, email, role, name, phone, pass }));\r\n      dispatch(loadUsers({userId}))\r\n      togglePopup();\r\n      resetForm();\r\n    }\r\n  }, [validate.errorMessage]);\r\n  const userId = localStorage.userId;\r\n\r\n  const resetForm = () => {\r\n    setCity(\"\");\r\n    setEmail(\"\");\r\n    setName(\"\");\r\n    setPass(\"\");\r\n    setPhone(\"\");\r\n    setRole(ROLES.user.id);\r\n  };\r\n  const handleValidate = () => {\r\n    if (\r\n      isEmpty(email) ||\r\n      isEmpty(phone) ||\r\n      isEmpty(city) ||\r\n      isEmpty(pass) ||\r\n      isEmpty(name)\r\n    ) {\r\n      setValidate({\r\n        isValid: false,\r\n        errorMessage: \"Пожалуйста, заполните все поля\",\r\n      });\r\n    } else if (!isEmail(email)) {\r\n      setValidate({\r\n        isValid: false,\r\n        errorMessage: \"Неверный формат почты\",\r\n      });\r\n    } else if (\r\n      !isMobilePhone(phone) ||\r\n      phone.length < 10 ||\r\n      phone.length > 14\r\n    ) {\r\n      setValidate({\r\n        isValid: false,\r\n        errorMessage: \"Неверный номер телефона\",\r\n      });\r\n    } else setValidate({ isValid: true, errorMessage: \"   \" });\r\n  };\r\n\r\n  const onSubmit = (event) => {\r\n    event.preventDefault();\r\n    handleValidate();\r\n  };\r\n\r\n  return (\r\n    <FormElem\r\n      title={\"Добавление пользователя\"}\r\n      onSubmit={onSubmit}>\r\n      <InputText\r\n        value={name}\r\n        label={\"Наименование\"}\r\n        setValue={setName}\r\n      />\r\n      <InputText\r\n        value={email}\r\n        label={\"email\"}\r\n        setValue={setEmail}\r\n      />\r\n      <InputPhone\r\n        value={phone}\r\n        label={\"Телефон\"}\r\n        setValue={setPhone}\r\n      />\r\n      <InputText\r\n        value={city}\r\n        label={\"Город\"}\r\n        setValue={setCity}\r\n      />\r\n      <InputPass\r\n        value={pass}\r\n        label={\"Пароль\"}\r\n        setValue={setPass}\r\n      />\r\n      <span className={styles.radios_label}>Выберите роль:</span>\r\n      <div className={styles.radios_container}>\r\n        <InputRadio\r\n          label={ROLES.user.content}\r\n          value={ROLES.user.id}\r\n          checked={role === ROLES.user.id}\r\n          setValue={setRole}\r\n        />\r\n        <InputRadio\r\n          label={ROLES.master.content}\r\n          value={ROLES.master.id}\r\n          checked={role === ROLES.master.id}\r\n          setValue={setRole}\r\n        />\r\n        <InputRadio\r\n          label={ROLES.admin.content}\r\n          value={ROLES.admin.id}\r\n          checked={role === ROLES.admin.id}\r\n          setValue={setRole}\r\n        />\r\n      </div>\r\n      <span className={styles.errorMessage}>{validate.errorMessage}</span>\r\n      <button\r\n        type=\"submit\"\r\n        className={classNames(styles.button, styles.form_submit)}>\r\n        Добавить ползователя\r\n      </button>\r\n    </FormElem>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}