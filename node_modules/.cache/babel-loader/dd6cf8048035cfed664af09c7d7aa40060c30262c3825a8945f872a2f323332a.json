{"ast":null,"code":"import _objectSpread from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{selectFranshises}from\"../../store/Franshises/selectors\";import{addObject}from\"../../store/Objects/Thunks/addObject\";import{FormElem}from\"../FormElem/FormElem\";import styles from\"./styles.module.css\";import{isEmpty,isMobilePhone}from\"validator\";import{InputText}from\"../../UI/InputText/InputText\";import{InputSelect}from\"../../UI/InputSelect/InputSelect\";import{InputPhone}from\"../../UI/InputPhone/InputPhone\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AddObjectForm=function AddObjectForm(_ref){var _franshisesMap$;var togglePopup=_ref.togglePopup;var dispatch=useDispatch();var initialValidate={validate:undefined,errorMessage:\" \"};var franshises=useSelector(function(state){return selectFranshises(state);});var _useState=useState(initialValidate),_useState2=_slicedToArray(_useState,2),validate=_useState2[0],setValidate=_useState2[1];useEffect(function(){if(validate.errorMessage.length<5&&form.phone.length>7){dispatch(addObject(_objectSpread(_objectSpread({},form),{},{userId:userId})));togglePopup();}},[validate.errorMessage]);var franshisesMap=Object.values(franshises).map(function(el){return{value:el.ID,label:el.COMPANY};});var _useState3=useState({name:\"\",idFran:((_franshisesMap$=franshisesMap[0])===null||_franshisesMap$===void 0?void 0:_franshisesMap$.value)||' ',orgOwner:\"\",phone:\"\",worker:\"\"}),_useState4=_slicedToArray(_useState3,2),form=_useState4[0],_setForm=_useState4[1];var userId=localStorage.userId;var handleValidate=function handleValidate(){if(Object.values(form).some(function(el){return isEmpty(el);})){setValidate({errorMessage:\"Необходимо заполнить все поля\",isValid:false});}else if(!isMobilePhone(form.phone)||form.phone.length<10){setValidate({errorMessage:\"Неверный формат номера телефона\",isValid:false});}else setValidate({isValid:true,errorMessage:\"   \"});return validate.isValid;};var onSubmit=function onSubmit(event){event.preventDefault();handleValidate();};return/*#__PURE__*/_jsxs(FormElem,{title:\"Добавление объекта\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:classNames(styles.button,styles.popup_closeButton),onClick:function onClick(){return togglePopup();}}),/*#__PURE__*/_jsx(InputText,{value:form.name,label:\"Наименование\",setValue:function setValue(e){return _setForm(_objectSpread(_objectSpread({},form),{},{name:e}));}}),/*#__PURE__*/_jsx(InputSelect,{mapValues:franshisesMap,setForm:function setForm(e){return _setForm(_objectSpread(_objectSpread({},form),{},{idFran:e}));},label:\"Франшиза\",value:form.idFran}),/*#__PURE__*/_jsx(InputText,{value:form.orgOwner,label:\"Имя владельца\",setValue:function setValue(e){return _setForm(_objectSpread(_objectSpread({},form),{},{orgOwner:e}));}}),/*#__PURE__*/_jsx(InputPhone,{label:\"Телефон\",value:form.phone,setValue:function setValue(e){return _setForm(_objectSpread(_objectSpread({},form),{},{phone:e}));}}),/*#__PURE__*/_jsx(InputText,{label:\"Специалист\",value:form.worker,setValue:function setValue(e){return _setForm(_objectSpread(_objectSpread({},form),{},{worker:e}));}}),/*#__PURE__*/_jsx(\"span\",{className:styles.errorMessage,children:validate.errorMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:classNames(styles.button,styles.form_submit),children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043E\\u0431\\u044A\\u0435\\u043A\\u0442\"})]});};","map":{"version":3,"names":["classNames","useEffect","useState","useDispatch","useSelector","selectFranshises","addObject","FormElem","styles","isEmpty","isMobilePhone","InputText","InputSelect","InputPhone","AddObjectForm","togglePopup","dispatch","initialValidate","validate","undefined","errorMessage","franshises","state","setValidate","length","form","phone","userId","franshisesMap","Object","values","map","el","value","ID","label","COMPANY","name","idFran","orgOwner","worker","setForm","localStorage","handleValidate","some","isValid","onSubmit","event","preventDefault","button","popup_closeButton","e","form_submit"],"sources":["D:/dev/uno/src/Components/AddObjectForm/AddObjectForm.jsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  selectFranshises,\r\n} from \"../../store/Franshises/selectors\";\r\nimport { addObject } from \"../../store/Objects/Thunks/addObject\";\r\nimport { FormElem } from \"../FormElem/FormElem\";\r\nimport styles from \"./styles.module.css\";\r\nimport { isEmpty, isMobilePhone } from \"validator\";\r\nimport {InputText} from \"../../UI/InputText/InputText\"\r\nimport {InputSelect} from \"../../UI/InputSelect/InputSelect\"\r\nimport {InputPhone} from \"../../UI/InputPhone/InputPhone\"\r\n\r\nexport const AddObjectForm = ({ togglePopup }) => {\r\n  const dispatch = useDispatch();\r\n  const initialValidate = {\r\n    validate: undefined,\r\n    errorMessage: \" \",\r\n  };\r\n  const franshises = useSelector((state) => selectFranshises(state));\r\n  const [validate, setValidate] = useState(initialValidate);\r\n  useEffect(() => {\r\n    if (validate.errorMessage.length < 5 && form.phone.length > 7) {\r\n      dispatch(addObject({ ...form, userId }));\r\n      togglePopup();\r\n    }\r\n  }, [validate.errorMessage]);\r\n\r\n  const franshisesMap = Object.values(franshises).map((el) => {\r\n    return {\r\n      value: el.ID,\r\n      label: el.COMPANY,\r\n    };\r\n  });\r\n  const [form, setForm] = useState({\r\n    name: \"\",\r\n    idFran: franshisesMap[0]?.value || ' ',\r\n    orgOwner: \"\",\r\n    phone: \"\",\r\n    worker: \"\",\r\n  });\r\n\r\n  const userId = localStorage.userId;\r\n  const handleValidate = () => {\r\n    if (Object.values(form).some((el) => isEmpty(el))) {\r\n      setValidate({\r\n        errorMessage: \"Необходимо заполнить все поля\",\r\n        isValid: false,\r\n      });\r\n    } else if (!isMobilePhone(form.phone) || form.phone.length < 10) {\r\n      setValidate({\r\n        errorMessage: \"Неверный формат номера телефона\",\r\n        isValid: false,\r\n      });\r\n    } else setValidate({ isValid: true, errorMessage: \"   \" });\r\n    return validate.isValid;\r\n  };\r\n\r\n  const onSubmit = (event) => {\r\n    event.preventDefault();\r\n    handleValidate();\r\n  };\r\n  return (\r\n    <FormElem\r\n      title={\"Добавление объекта\"}\r\n      onSubmit={onSubmit}>\r\n      <button\r\n        type=\"button\"\r\n        className={classNames(styles.button, styles.popup_closeButton)}\r\n        onClick={() => togglePopup()}\r\n      />\r\n      <InputText\r\n        value={form.name}\r\n        label={\"Наименование\"}\r\n        setValue={(e) => setForm({ ...form, name: e })}\r\n      />\r\n      <InputSelect\r\n        mapValues={franshisesMap}\r\n        setForm={(e) => setForm({ ...form, idFran: e })}\r\n        label={\"Франшиза\"}\r\n        value={form.idFran}\r\n      />\r\n      <InputText\r\n        value={form.orgOwner}\r\n        label={\"Имя владельца\"}\r\n        setValue={(e) => setForm({ ...form, orgOwner: e })}\r\n      />\r\n      <InputPhone\r\n        label={\"Телефон\"}\r\n        value={form.phone}\r\n        setValue={(e) => setForm({ ...form, phone: e })}\r\n      />\r\n      <InputText\r\n        label={\"Специалист\"}\r\n        value={form.worker}\r\n        setValue={(e) => setForm({ ...form, worker: e })}\r\n      />\r\n      <span className={styles.errorMessage}>{validate.errorMessage}</span>\r\n      <button\r\n        type=\"submit\"\r\n        className={classNames(styles.button, styles.form_submit)}>\r\n        Добавить объект\r\n      </button>\r\n    </FormElem>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}